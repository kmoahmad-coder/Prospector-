<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prospector</title>

<style>
:root {
  --bg: #080810;
  --surface: #0f0f1a;
  --surface2: #151525;
  --border: #1c1c30;
  --accent: #00e5a0;
  --accent2: #6c5ce7;
  --accent3: #fd79a8;
  --text: #e8e8f2;
  --muted: #4a4a6a;
  --hunter: #ff6b35;
  --snov: #00b4d8;
  --drop: #a29bfe;
}
* { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; }
body { background: var(--bg); color: var(--text); font-family: -apple-system, 'SF Pro Text', 'Helvetica Neue', sans-serif; min-height: 100vh; overflow-x: hidden; }
.bg-grid { position: fixed; inset: 0; background-image: linear-gradient(rgba(108,92,231,0.04) 1px, transparent 1px), linear-gradient(90deg, rgba(108,92,231,0.04) 1px, transparent 1px); background-size: 32px 32px; pointer-events: none; z-index: 0; }
.bg-glow1 { position: fixed; top: -300px; left: -200px; width: 700px; height: 700px; background: radial-gradient(circle, rgba(108,92,231,0.07) 0%, transparent 65%); pointer-events: none; z-index: 0; }
.bg-glow2 { position: fixed; bottom: -200px; right: -100px; width: 500px; height: 500px; background: radial-gradient(circle, rgba(0,229,160,0.05) 0%, transparent 65%); pointer-events: none; z-index: 0; }
.app { display: flex; min-height: 100vh; position: relative; z-index: 1; }

/* SIDEBAR */
.sidebar { width: 260px; min-width: 260px; background: var(--surface); border-right: 1px solid var(--border); display: flex; flex-direction: column; height: 100vh; position: sticky; top: 0; overflow-y: auto; }
.logo { padding: 28px 24px 22px; border-bottom: 1px solid var(--border); }
.logo-text { font-family: 'Arial Black', 'Impact', sans-serif; letter-spacing: 2px; text-transform: uppercase; font-size: 28px; letter-spacing: 2px; background: linear-gradient(135deg, var(--accent), var(--accent2)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; line-height: 1; }
.logo-sub { font-size: 10px; color: var(--muted); letter-spacing: 2px; text-transform: uppercase; margin-top: 4px; font-family: 'Courier New', 'Menlo', monospace; }
.credit-bank { padding: 20px; border-bottom: 1px solid var(--border); }
.bank-title { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--muted); font-family: 'Courier New', 'Menlo', monospace; margin-bottom: 14px; display: flex; align-items: center; justify-content: space-between; }
.bank-total { font-family: 'Arial Black', 'Impact', sans-serif; letter-spacing: 2px; text-transform: uppercase; font-size: 36px; letter-spacing: 1px; line-height: 1; margin-bottom: 4px; background: linear-gradient(135deg, var(--accent), #00b4d8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
.bank-subtitle { font-size: 11px; color: var(--muted); margin-bottom: 18px; }
.provider-bars { display: flex; flex-direction: column; gap: 12px; }
.provider-bar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
.provider-name { font-size: 11px; font-weight: 600; display: flex; align-items: center; gap: 6px; }
.provider-dot { width: 6px; height: 6px; border-radius: 50%; flex-shrink: 0; }
.provider-count { font-family: 'Courier New', 'Menlo', monospace; font-size: 10px; color: var(--muted); }
.bar-track { height: 4px; background: var(--border); border-radius: 2px; overflow: hidden; }
.bar-fill { height: 100%; border-radius: 2px; transition: width 0.5s ease; }
.nav { padding: 16px 12px; flex: 1; }
.nav-item { display: flex; align-items: center; gap: 10px; padding: 10px 12px; border-radius: 8px; cursor: pointer; font-size: 13px; font-weight: 500; color: var(--muted); transition: all 0.15s; margin-bottom: 2px; }
.nav-item:hover { background: var(--surface2); color: var(--text); }
.nav-item.active { background: rgba(0,229,160,0.08); color: var(--accent); }
.keys-section { padding: 16px 20px 20px; border-top: 1px solid var(--border); }
.keys-title { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--muted); font-family: 'Courier New', 'Menlo', monospace; margin-bottom: 12px; }
.key-row { margin-bottom: 10px; }
.key-label { font-size: 11px; font-weight: 600; margin-bottom: 5px; display: flex; align-items: center; gap: 6px; }
.key-input { width: 100%; background: var(--bg); border: 1px solid var(--border); border-radius: 7px; padding: 8px 10px; color: var(--text); font-family: 'Courier New', 'Menlo', monospace; font-size: 11px; outline: none; transition: border 0.15s; }
.key-input:focus { border-color: var(--accent); }
.key-input::placeholder { color: var(--muted); }
.key-status { display: inline-block; width: 6px; height: 6px; border-radius: 50%; background: var(--border); margin-left: 4px; }
.key-status.active { background: var(--accent); box-shadow: 0 0 6px var(--accent); }

/* MAIN */
.main { flex: 1; min-width: 0; display: flex; flex-direction: column; }
.topbar { padding: 20px 28px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; background: rgba(8,8,16,0.85); backdrop-filter: blur(12px); position: sticky; top: 0; z-index: 5; gap: 16px; }
.page-title { font-family: 'Arial Black', 'Impact', sans-serif; letter-spacing: 2px; text-transform: uppercase; font-size: 22px; letter-spacing: 2px; white-space: nowrap; }
.topbar-right { display: flex; align-items: center; gap: 10px; flex-shrink: 0; }
.chip { font-family: 'Courier New', 'Menlo', monospace; font-size: 11px; padding: 5px 10px; border-radius: 20px; border: 1px solid var(--border); color: var(--muted); white-space: nowrap; }
.chip b { color: var(--accent); }
.mobile-nav { display: none; background: var(--surface); border-bottom: 1px solid var(--border); padding: 0 4px; overflow-x: auto; -webkit-overflow-scrolling: touch; scrollbar-width: none; }
.mobile-nav::-webkit-scrollbar { display: none; }
.mobile-nav-inner { display: flex; gap: 2px; padding: 8px 4px; white-space: nowrap; }
.mobile-nav-item { padding: 8px 16px; border-radius: 8px; font-size: 13px; font-weight: 500; color: var(--muted); cursor: pointer; transition: all 0.15s; flex-shrink: 0; }
.mobile-nav-item.active { background: rgba(0,229,160,0.1); color: var(--accent); }
.content { padding: 24px 28px; flex: 1; }
.card { background: var(--surface); border: 1px solid var(--border); border-radius: 14px; padding: 24px; margin-bottom: 20px; }
.card-title { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--muted); font-family: 'Courier New', 'Menlo', monospace; margin-bottom: 18px; }
.search-fields { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 14px; }
.field-group { display: flex; flex-direction: column; gap: 6px; }
.field-label { font-size: 11px; color: var(--muted); font-family: 'Courier New', 'Menlo', monospace; letter-spacing: 0.5px; text-transform: uppercase; }
.field-input { background: var(--bg); border: 1px solid var(--border); border-radius: 10px; padding: 12px 14px; color: var(--text); font-family: -apple-system, 'SF Pro Text', 'Helvetica Neue', sans-serif; font-size: 14px; outline: none; transition: all 0.15s; width: 100%; }
.field-input:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(0,229,160,0.07); }
.field-input::placeholder { color: var(--muted); }
.btn-primary { background: var(--accent); color: #000; border: none; border-radius: 10px; padding: 13px 28px; font-family: -apple-system, 'SF Pro Text', 'Helvetica Neue', sans-serif; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.15s; display: inline-flex; align-items: center; gap: 8px; white-space: nowrap; }
.btn-primary:hover { filter: brightness(1.1); transform: translateY(-1px); box-shadow: 0 8px 24px rgba(0,229,160,0.25); }
.btn-primary:active { transform: translateY(0); }
.btn-primary:disabled { opacity: 0.4; cursor: not-allowed; transform: none; filter: none; box-shadow: none; }
.btn-secondary { background: transparent; border: 1px solid var(--border); border-radius: 10px; padding: 10px 18px; color: var(--text); font-family: -apple-system, 'SF Pro Text', 'Helvetica Neue', sans-serif; font-weight: 500; font-size: 13px; cursor: pointer; transition: all 0.15s; display: inline-flex; align-items: center; gap: 6px; }
.btn-secondary:hover { border-color: var(--accent); color: var(--accent); }
.search-actions { display: flex; align-items: center; justify-content: space-between; gap: 12px; flex-wrap: wrap; }
.active-provider { font-size: 12px; color: var(--muted); display: flex; align-items: center; gap: 6px; font-family: 'Courier New', 'Menlo', monospace; }
.active-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--accent); box-shadow: 0 0 8px var(--accent); animation: blink 1.5s ease-in-out infinite; }
@keyframes blink { 0%,100%{opacity:1} 50%{opacity:0.3} }
.bulk-toggle { display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 12px; color: var(--muted); padding-top: 16px; border-top: 1px solid var(--border); margin-top: 16px; transition: color 0.15s; user-select: none; }
.bulk-toggle:hover { color: var(--text); }
.bulk-area { display: none; margin-top: 16px; }
.bulk-area.open { display: block; }
.bulk-textarea { width: 100%; background: var(--bg); border: 1px solid var(--border); border-radius: 10px; padding: 14px; color: var(--text); font-family: 'Courier New', 'Menlo', monospace; font-size: 12px; outline: none; resize: vertical; min-height: 110px; line-height: 1.8; transition: border 0.15s; margin-bottom: 10px; }
.bulk-textarea:focus { border-color: var(--accent); }
.bulk-textarea::placeholder { color: var(--muted); }
.bulk-hint { font-size: 11px; color: var(--muted); font-family: 'Courier New', 'Menlo', monospace; margin-bottom: 10px; }
.progress-wrap { background: var(--border); border-radius: 4px; height: 3px; overflow: hidden; margin: 10px 0 6px; display: none; }
.progress-wrap.on { display: block; }
.progress-bar { height: 100%; background: linear-gradient(90deg, var(--accent2), var(--accent)); border-radius: 4px; transition: width 0.4s; width: 0; }
.progress-label { font-family: 'Courier New', 'Menlo', monospace; font-size: 11px; color: var(--muted); display: none; margin-bottom: 10px; }
.progress-label.on { display: block; }
.results-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 14px; gap: 10px; flex-wrap: wrap; }
.results-title { font-family: -apple-system, 'SF Pro Text', 'Helvetica Neue', sans-serif; font-weight: 700; font-size: 16px; }
.contacts-list { display: flex; flex-direction: column; gap: 8px; }
.contact-card { background: var(--surface); border: 1px solid var(--border); border-radius: 12px; padding: 16px 18px; display: flex; align-items: center; gap: 14px; transition: all 0.15s; animation: fadeUp 0.3s ease forwards; opacity: 0; transform: translateY(6px); }
@keyframes fadeUp { to { opacity:1; transform:translateY(0); } }
.contact-card:hover { border-color: rgba(0,229,160,0.2); background: var(--surface2); }
.avatar { width: 40px; height: 40px; border-radius: 10px; background: linear-gradient(135deg, var(--accent2), var(--accent)); display: flex; align-items: center; justify-content: center; font-family: 'Arial Black', 'Impact', sans-serif; letter-spacing: 2px; text-transform: uppercase; font-size: 16px; letter-spacing: 1px; color: #fff; flex-shrink: 0; }
.contact-info { flex: 1; min-width: 0; }
.contact-name { font-weight: 600; font-size: 14px; margin-bottom: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.contact-meta { font-size: 12px; color: var(--muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.contact-right { display: flex; align-items: center; gap: 10px; flex-shrink: 0; }
.email-pill { font-family: 'Courier New', 'Menlo', monospace; font-size: 12px; color: var(--accent); background: rgba(0,229,160,0.07); border: 1px solid rgba(0,229,160,0.15); padding: 5px 11px; border-radius: 6px; cursor: pointer; transition: all 0.15s; max-width: 220px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.email-pill:hover { background: rgba(0,229,160,0.12); }
.email-pill.empty { color: var(--muted); background: transparent; border-color: var(--border); cursor: default; }
.score-badge { font-family: 'Courier New', 'Menlo', monospace; font-size: 12px; font-weight: 500; min-width: 32px; text-align: center; }
.score-h { color: var(--accent); }
.score-m { color: #ffb547; }
.score-l { color: #ff4e6a; }
.icon-btn { background: transparent; border: none; cursor: pointer; font-size: 16px; padding: 4px; transition: transform 0.15s; line-height: 1; }
.icon-btn:hover { transform: scale(1.2); }
.provider-badge { font-family: 'Courier New', 'Menlo', monospace; font-size: 9px; padding: 2px 6px; border-radius: 4px; text-transform: uppercase; letter-spacing: 0.5px; flex-shrink: 0; }
.badge-hunter { background: rgba(255,107,53,0.15); color: var(--hunter); }
.badge-snov { background: rgba(0,180,216,0.15); color: var(--snov); }
.badge-drop { background: rgba(162,155,254,0.15); color: var(--drop); }
.empty-state { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 60px 20px; text-align: center; color: var(--muted); }
.empty-icon { font-size: 40px; margin-bottom: 14px; opacity: 0.4; }
.empty-title { font-weight: 700; font-size: 17px; color: var(--text); margin-bottom: 6px; }
.empty-desc { font-size: 13px; line-height: 1.6; max-width: 280px; }
.toast { position: fixed; bottom: 20px; right: 20px; background: var(--surface2); border: 1px solid var(--border); border-radius: 10px; padding: 12px 18px; font-size: 13px; z-index: 999; display: flex; align-items: center; gap: 8px; opacity: 0; transform: translateY(10px); transition: all 0.2s; max-width: 300px; }
.toast.show { opacity: 1; transform: translateY(0); }
.domain-email-row { display: flex; align-items: center; justify-content: space-between; padding: 12px 14px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; margin-bottom: 8px; animation: fadeUp 0.3s ease forwards; opacity: 0; gap: 12px; }
.domain-email-left { min-width: 0; flex: 1; }
.domain-email-addr { font-family: 'Courier New', 'Menlo', monospace; font-size: 12px; color: var(--accent); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.domain-email-name { font-size: 11px; color: var(--muted); margin-top: 2px; }
.copy-btn { background: transparent; border: 1px solid var(--border); border-radius: 6px; padding: 5px 10px; color: var(--muted); font-size: 11px; cursor: pointer; font-family: 'Courier New', 'Menlo', monospace; transition: all 0.15s; flex-shrink: 0; }
.copy-btn:hover { border-color: var(--accent); color: var(--accent); }

/* MOBILE KEYS MODAL */
.modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.75); z-index: 50; align-items: flex-end; justify-content: center; }
.modal-overlay.open { display: flex; }
.modal-sheet { background: var(--surface); border-radius: 20px 20px 0 0; padding: 24px 20px 48px; width: 100%; max-width: 500px; border-top: 1px solid var(--border); animation: slideUp 0.25s ease; }
@keyframes slideUp { from { transform: translateY(40px); opacity:0; } }
.modal-handle { width: 36px; height: 4px; background: var(--border); border-radius: 2px; margin: 0 auto 20px; }
.modal-title { font-family: 'Arial Black', 'Impact', sans-serif; letter-spacing: 2px; text-transform: uppercase; font-size: 24px; letter-spacing: 1px; margin-bottom: 4px; }
.modal-sub { font-size: 12px; color: var(--muted); margin-bottom: 20px; line-height: 1.5; }

/* MOBILE BANK STRIP */
.mobile-bank { display: none; background: var(--surface); border-bottom: 1px solid var(--border); padding: 14px 16px; }
.mobile-bank-inner { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; }
.mobile-bank-credits { font-family: 'Arial Black', 'Impact', sans-serif; letter-spacing: 2px; text-transform: uppercase; font-size: 30px; letter-spacing: 1px; background: linear-gradient(135deg, var(--accent), var(--snov)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
.mobile-bank-label { font-size: 10px; color: var(--muted); font-family: 'Courier New', 'Menlo', monospace; letter-spacing: 1px; text-transform: uppercase; }
.keys-btn { background: rgba(0,229,160,0.08); border: 1px solid rgba(0,229,160,0.2); border-radius: 8px; padding: 8px 14px; color: var(--accent); font-size: 12px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 6px; font-family: -apple-system, 'SF Pro Text', 'Helvetica Neue', sans-serif; }
.mobile-bars { display: flex; gap: 10px; }
.mobile-bar-item { flex: 1; }
.mobile-bar-label { font-size: 9px; color: var(--muted); font-family: 'Courier New', 'Menlo', monospace; margin-bottom: 4px; display: flex; justify-content: space-between; }

@media (max-width: 768px) {
  .sidebar { display: none; }
  .mobile-bank { display: block; }
  .mobile-nav { display: block; }
  .content { padding: 16px; }
  .topbar { padding: 14px 16px; }
  .search-fields { grid-template-columns: 1fr; }
  .contact-right { flex-wrap: wrap; gap: 6px; }
  .email-pill { max-width: 160px; font-size: 11px; }
  .score-badge { display: none; }
  .card { padding: 18px 16px; }
  .page-title { font-size: 18px; }
}
</style>

</head>
<body>
<div class="bg-grid"></div>
<div class="bg-glow1"></div>
<div class="bg-glow2"></div>

<!-- Mobile Keys Modal -->

<div class="modal-overlay" id="keysModal" onclick="closeModal(event)">
  <div class="modal-sheet">
    <div class="modal-handle"></div>
    <div class="modal-title">API Keys</div>
    <div class="modal-sub">Paste your keys once ‚Äî saved forever. Monthly quotas reset automatically, keys stay the same.</div>
    <div class="key-row">
      <div class="key-label" style="color:var(--hunter)">‚óè Hunter.io <span class="key-status" id="mHunterStatus"></span></div>
      <input class="key-input" type="password" id="mHunterKey" placeholder="Paste Hunter.io key..." oninput="syncKey('hunter', this.value)" />
    </div>
    <div class="key-row" style="margin-top:12px">
      <div class="key-label" style="color:var(--snov)">‚óè Snov.io</div>
      <input class="key-input" type="password" id="mSnovClientId" placeholder="Client ID..." oninput="syncKey('snovClientId', this.value)" style="margin-bottom:6px" />
      <input class="key-input" type="password" id="mSnovClientSecret" placeholder="Client Secret..." oninput="syncKey('snovClientSecret', this.value)" />
    </div>
    <div class="key-row" style="margin-top:12px">
      <div class="key-label" style="color:var(--drop)">‚óè Dropcontact <span class="key-status" id="mDropStatus"></span></div>
      <input class="key-input" type="password" id="mDropKey" placeholder="Paste Dropcontact key..." oninput="syncKey('drop', this.value)" />
    </div>
    <button class="btn-primary" style="margin-top:20px; width:100%; justify-content:center;" onclick="closeModalBtn()">Save & Close</button>
  </div>
</div>

<div class="app">
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="logo">
      <div class="logo-text">PROSPECTOR</div>
      <div class="logo-sub">Lead Intelligence</div>
    </div>
    <div class="credit-bank">
      <div class="bank-title">
        Credit Bank
        <span style="color:var(--accent);cursor:pointer;font-size:9px;" onclick="updateBank()">‚Üª REFRESH</span>
      </div>
      <div class="bank-total" id="bankTotal">0</div>
      <div class="bank-subtitle">searches remaining this month</div>
      <div class="provider-bars">
        <div class="provider-bar">
          <div class="provider-bar-header">
            <div class="provider-name"><div class="provider-dot" style="background:var(--hunter)"></div>Hunter.io</div>
            <div class="provider-count" id="hunterCount">0 / 25</div>
          </div>
          <div class="bar-track"><div class="bar-fill" id="hunterBar" style="background:var(--hunter);width:0%"></div></div>
        </div>
        <div class="provider-bar">
          <div class="provider-bar-header">
            <div class="provider-name"><div class="provider-dot" style="background:var(--snov)"></div>Snov.io</div>
            <div class="provider-count" id="snovCount">0 / 50</div>
          </div>
          <div class="bar-track"><div class="bar-fill" id="snovBar" style="background:var(--snov);width:0%"></div></div>
        </div>
        <div class="provider-bar">
          <div class="provider-bar-header">
            <div class="provider-name"><div class="provider-dot" style="background:var(--drop)"></div>Dropcontact</div>
            <div class="provider-count" id="dropCount">0 / 100</div>
          </div>
          <div class="bar-track"><div class="bar-fill" id="dropBar" style="background:var(--drop);width:0%"></div></div>
        </div>
      </div>
    </div>
    <nav class="nav">
      <div class="nav-item active" onclick="switchView('search',this)">üîç Find Contacts</div>
      <div class="nav-item" onclick="switchView('domain',this)">üè¢ Domain Search</div>
      <div class="nav-item" onclick="switchView('saved',this)">‚≠ê Saved Leads</div>
    </nav>
    <div class="keys-section">
      <div class="keys-title">API Keys ‚Äî saved automatically</div>
      <div class="key-row">
        <div class="key-label" style="font-size:12px;color:var(--hunter)">‚óè Hunter.io <span class="key-status" id="hunterStatus"></span></div>
        <input class="key-input" type="password" id="hunterKey" placeholder="Paste key..." oninput="syncKey('hunter',this.value)" />
      </div>
      <div class="key-row">
        <div class="key-label" style="font-size:12px;color:var(--snov)">‚óè Snov.io</div>
        <input class="key-input" type="password" id="snovClientId" placeholder="Client ID..." oninput="syncKey('snovClientId',this.value)" style="margin-bottom:5px" />
        <input class="key-input" type="password" id="snovClientSecret" placeholder="Client Secret..." oninput="syncKey('snovClientSecret',this.value)" />
      </div>
      <div class="key-row">
        <div class="key-label" style="font-size:12px;color:var(--drop)">‚óè Dropcontact <span class="key-status" id="dropStatus"></span></div>
        <input class="key-input" type="password" id="dropKey" placeholder="Paste key..." oninput="syncKey('drop',this.value)" />
      </div>
      <div style="margin-top:10px;font-size:10px;color:var(--muted);line-height:1.6;">Keys are stored locally in your browser. Monthly quotas reset automatically ‚Äî your keys never change.</div>
    </div>
  </div>

  <!-- Main -->

  <div class="main">
    <div class="topbar">
      <div class="page-title">LEAD INTELLIGENCE</div>
      <div class="topbar-right">
        <div class="chip">Bank: <b id="topBankTotal">0</b></div>
        <div class="chip"><b id="totalSaved">0</b> saved</div>
      </div>
    </div>

```
<!-- Mobile bank strip -->
<div class="mobile-bank">
  <div class="mobile-bank-inner">
    <div>
      <div class="mobile-bank-credits" id="mobileBankTotal">0</div>
      <div class="mobile-bank-label">Credits Remaining</div>
    </div>
    <button class="keys-btn" onclick="openModal()">üîë API Keys</button>
  </div>
  <div class="mobile-bars">
    <div class="mobile-bar-item">
      <div class="mobile-bar-label"><span style="color:var(--hunter)">Hunter</span><span id="mHCount">0</span></div>
      <div class="bar-track"><div class="bar-fill" id="mHBar" style="background:var(--hunter);width:0%"></div></div>
    </div>
    <div class="mobile-bar-item">
      <div class="mobile-bar-label"><span style="color:var(--snov)">Snov</span><span id="mSCount">0</span></div>
      <div class="bar-track"><div class="bar-fill" id="mSBar" style="background:var(--snov);width:0%"></div></div>
    </div>
    <div class="mobile-bar-item">
      <div class="mobile-bar-label"><span style="color:var(--drop)">Drop</span><span id="mDCount">0</span></div>
      <div class="bar-track"><div class="bar-fill" id="mDBar" style="background:var(--drop);width:0%"></div></div>
    </div>
  </div>
</div>

<!-- Mobile nav -->
<div class="mobile-nav">
  <div class="mobile-nav-inner">
    <div class="mobile-nav-item active" onclick="switchView('search',this)">üîç Find Contacts</div>
    <div class="mobile-nav-item" onclick="switchView('domain',this)">üè¢ Domain Search</div>
    <div class="mobile-nav-item" onclick="switchView('saved',this)">‚≠ê Saved</div>
  </div>
</div>

<div class="content">
  <!-- Search View -->
  <div id="view-search">
    <div class="card">
      <div class="card-title">üéØ Find Email by Name + Company</div>
      <div class="search-fields">
        <div class="field-group">
          <label class="field-label">Full Name</label>
          <input class="field-input" id="nameInput" placeholder="e.g. Sarah Johnson" />
        </div>
        <div class="field-group">
          <label class="field-label">Company Domain</label>
          <input class="field-input" id="domainInput" placeholder="e.g. stripe.com" />
        </div>
      </div>
      <div class="search-actions">
        <button class="btn-primary" onclick="searchContact()" id="searchBtn">Search</button>
        <div class="active-provider">
          <div class="active-dot"></div>
          <span id="activeProviderName">Auto-routing</span>
        </div>
      </div>
      <div class="bulk-toggle" onclick="toggleBulk()">
        <span id="bulkArrow">‚ñ∂</span> Bulk search ‚Äî paste multiple contacts
      </div>
      <div class="bulk-area" id="bulkArea">
        <textarea class="bulk-textarea" id="bulkInput" placeholder="Sarah Johnson, stripe.com&#10;John Smith, microsoft.com&#10;Jane Doe, salesforce.com"></textarea>
        <div class="bulk-hint">One per line: Full Name, domain.com</div>
        <div class="progress-wrap" id="progressWrap"><div class="progress-bar" id="progressBar"></div></div>
        <div class="progress-label" id="progressLabel"></div>
        <button class="btn-primary" onclick="runBulk()" id="bulkBtn" style="background:var(--accent2);color:#fff;">‚ö° Bulk Search</button>
      </div>
    </div>
    <div id="searchResults">
      <div class="empty-state">
        <div class="empty-icon">üéØ</div>
        <div class="empty-title">Find anyone's work email</div>
        <div class="empty-desc">Enter a name and company domain. Searches auto-rotate across all connected providers.</div>
      </div>
    </div>
  </div>

  <!-- Domain View -->
  <div id="view-domain" style="display:none">
    <div class="card">
      <div class="card-title">üè¢ All emails at a company</div>
      <div class="search-fields" style="grid-template-columns:1fr">
        <div class="field-group">
          <label class="field-label">Company Domain</label>
          <input class="field-input" id="domainSearchInput" placeholder="e.g. stripe.com" />
        </div>
      </div>
      <button class="btn-primary" onclick="searchDomain()" id="domainBtn">Search Domain</button>
    </div>
    <div id="domainResults">
      <div class="empty-state">
        <div class="empty-icon">üè¢</div>
        <div class="empty-title">Domain email lookup</div>
        <div class="empty-desc">Find all publicly discoverable emails at any company. Uses Hunter.io.</div>
      </div>
    </div>
  </div>

  <!-- Saved View -->
  <div id="view-saved" style="display:none">
    <div class="results-header">
      <div class="results-title">‚≠ê Saved Leads</div>
      <button class="btn-secondary" onclick="exportCSV()">‚¨á Export CSV</button>
    </div>
    <div id="savedResults">
      <div class="empty-state">
        <div class="empty-icon">‚≠ê</div>
        <div class="empty-title">No saved leads yet</div>
        <div class="empty-desc">Star any contact to save them here, then export to CSV.</div>
      </div>
    </div>
  </div>
</div>
```

  </div>
</div>

<div class="toast" id="toast"></div>

<script>
// Storage wrapper that falls back to memory if localStorage is blocked
const store = (() => {
  const mem = {};
  return {
    get: (k, def='') => { try { return localStorage.getItem(k) ?? def; } catch(e) { return mem[k] ?? def; } },
    set: (k, v) => { try { localStorage.setItem(k, v); } catch(e) { mem[k] = v; } },
  };
})();
let savedLeads = JSON.parse(store.get('p_leads', '[]'));
const MAX = { hunter: 25, snov: 50, drop: 100 };

function getKeys() {
  return {
    hunter: store.get('p_hunter') || '',
    snovClientId: store.get('p_snovClientId') || '',
    snovClientSecret: store.get('p_snovClientSecret') || '',
    drop: store.get('p_drop') || '',
  };
}

function syncKey(name, val) {
  store.set('p_' + name, val.trim());
  const mirrors = { hunter: ['hunterKey','mHunterKey'], snovClientId: ['snovClientId','mSnovClientId'], snovClientSecret: ['snovClientSecret','mSnovClientSecret'], drop: ['dropKey','mDropKey'] };
  (mirrors[name] || []).forEach(id => { const el = document.getElementById(id); if(el && el.value !== val) el.value = val; });
  updateKeyStatuses();
  updateBank();
}

function updateKeyStatuses() {
  const k = getKeys();
  setStatus('hunterStatus', !!k.hunter);
  setStatus('mHunterStatus', !!k.hunter);
  setStatus('dropStatus', !!k.drop);
  setStatus('mDropStatus', !!k.drop);
}

function setStatus(id, on) {
  const el = document.getElementById(id);
  if(el) el.classList.toggle('active', on);
}

function updateBank() {
  const k = getKeys();
  const hUsed = parseInt(store.get('p_hunterUsed', '0') || '0');
  const sUsed = parseInt(store.get('p_snovUsed', '0') || '0');
  const dUsed = parseInt(store.get('p_dropUsed', '0') || '0');

  const hCred = k.hunter ? Math.max(0, MAX.hunter - hUsed) : 0;
  const sCred = (k.snovClientId && k.snovClientSecret) ? Math.max(0, MAX.snov - sUsed) : 0;
  const dCred = k.drop ? Math.max(0, MAX.drop - dUsed) : 0;
  const total = hCred + sCred + dCred;

  setText('bankTotal', total);
  setText('topBankTotal', total);
  setText('mobileBankTotal', total);
  setText('hunterCount', hCred + ' / ' + MAX.hunter);
  setText('snovCount', sCred + ' / ' + MAX.snov);
  setText('dropCount', dCred + ' / ' + MAX.drop);
  setText('mHCount', hCred);
  setText('mSCount', sCred);
  setText('mDCount', dCred);

  setBar('hunterBar', hCred, MAX.hunter);
  setBar('snovBar', sCred, MAX.snov);
  setBar('dropBar', dCred, MAX.drop);
  setBar('mHBar', hCred, MAX.hunter);
  setBar('mSBar', sCred, MAX.snov);
  setBar('mDBar', dCred, MAX.drop);

  const active = hCred > 0 ? 'Hunter.io' : sCred > 0 ? 'Snov.io' : dCred > 0 ? 'Dropcontact' : 'No credits ‚Äî add keys';
  setText('activeProviderName', active);
}

function setBar(id, val, max) {
  const el = document.getElementById(id);
  if(el) el.style.width = (max > 0 ? (val / max * 100) : 0) + '%';
}

function setText(id, val) {
  const el = document.getElementById(id);
  if(el) el.textContent = val;
}

function getActiveProvider() {
  const k = getKeys();
  const hUsed = parseInt(store.get('p_hunterUsed', '0') || '0');
  const sUsed = parseInt(store.get('p_snovUsed', '0') || '0');
  const dUsed = parseInt(store.get('p_dropUsed', '0') || '0');
  if (k.hunter && MAX.hunter - hUsed > 0) return 'hunter';
  if (k.snovClientId && k.snovClientSecret && MAX.snov - sUsed > 0) return 'snov';
  if (k.drop && MAX.drop - dUsed > 0) return 'drop';
  return null;
}

function incrementUsed(provider) {
  const key = 'p_' + provider + 'Used';
  store.set(key, (parseInt(store.get(key, '0')) + 1).toString());
  updateBank();
}

async function searchContact() {
  const name = document.getElementById('nameInput').value.trim();
  const domain = document.getElementById('domainInput').value.trim();
  if (!name || !domain) { showToast('Enter a name and domain', 'error'); return; }
  const provider = getActiveProvider();
  if (!provider) { showToast('No credits ‚Äî add API keys first', 'error'); return; }
  const btn = document.getElementById('searchBtn');
  btn.disabled = true; btn.textContent = '...';
  try {
    const result = await findEmail(name, domain, provider);
    incrementUsed(provider);
    renderResults([result], 'searchResults');
  } catch(e) {
    renderNotFound('searchResults', name, domain, e.message);
  }
  btn.disabled = false; btn.textContent = 'Search';
}

async function findEmail(name, domain, provider) {
  const k = getKeys();
  const parts = name.trim().split(' ');
  const first = parts[0];
  const last = parts.slice(1).join(' ');

  if (provider === 'hunter') {
    const url = `https://api.hunter.io/v2/email-finder?domain=${encodeURIComponent(domain)}&first_name=${encodeURIComponent(first)}&last_name=${encodeURIComponent(last)}&api_key=${k.hunter}`;
    const res = await fetch(url);
    const data = await res.json();
    if (data.errors) throw new Error(data.errors[0]?.details || 'Hunter error');
    if (!data.data?.email) throw new Error('Not found');
    return { name, domain, email: data.data.email, score: data.data.score || 0, position: data.data.position || '', provider: 'hunter', id: Date.now() };
  }

  if (provider === 'snov') {
    const tokenRes = await fetch('https://api.snov.io/v1/oauth/access_token', {
      method: 'POST', headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ grant_type: 'client_credentials', client_id: k.snovClientId, client_secret: k.snovClientSecret })
    });
    const tokenData = await tokenRes.json();
    if (!tokenData.access_token) throw new Error('Snov auth failed');
    const res = await fetch('https://api.snov.io/v1/get-emails-from-names', {
      method: 'POST', headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ access_token: tokenData.access_token, firstName: first, lastName: last, domain })
    });
    const data = await res.json();
    const email = data.data?.emails?.[0]?.email;
    if (!email) throw new Error('Not found');
    return { name, domain, email, score: data.data.emails[0].confidence || 0, position: '', provider: 'snov', id: Date.now() };
  }

  if (provider === 'drop') {
    const res = await fetch('https://api.dropcontact.io/b2b-api/v2/enrich/single', {
      method: 'POST', headers: {'Content-Type':'application/json','X-Access-Token':k.drop},
      body: JSON.stringify({ first_name: first, last_name: last, website: domain })
    });
    const data = await res.json();
    const email = data.email?.[0]?.email;
    if (!email) throw new Error('Not found');
    return { name, domain, email, score: data.email[0].confidence || 0, position: data.job_title || '', provider: 'drop', id: Date.now() };
  }

  throw new Error('No provider');
}

async function searchDomain() {
  const domain = document.getElementById('domainSearchInput').value.trim();
  if (!domain) { showToast('Enter a domain', 'error'); return; }
  const k = getKeys();
  if (!k.hunter) { showToast('Domain search requires a Hunter.io key', 'error'); return; }
  const btn = document.getElementById('domainBtn');
  btn.disabled = true; btn.textContent = '...';
  try {
    const res = await fetch(`https://api.hunter.io/v2/domain-search?domain=${encodeURIComponent(domain)}&api_key=${k.hunter}&limit=20`);
    const data = await res.json();
    const container = document.getElementById('domainResults');
    if (data.data?.emails?.length) {
      incrementUsed('hunter');
      window._domainEmails = data.data.emails;
      container.innerHTML = `
        <div class="results-header">
          <div class="results-title">üìß ${data.data.emails.length} emails at <span style="color:var(--accent)">${data.data.organization || domain}</span></div>
          <button class="btn-secondary" onclick="exportDomainEmails()">‚¨á CSV</button>
        </div>
        <div id="domainList"></div>
      `;
      const list = document.getElementById('domainList');
      data.data.emails.forEach((e, i) => {
        const row = document.createElement('div');
        row.className = 'domain-email-row';
        row.style.animationDelay = (i * 0.04) + 's';
        const conf = e.confidence || 0;
        const cClass = conf >= 70 ? 'score-h' : conf >= 40 ? 'score-m' : 'score-l';
        row.innerHTML = `
          <div class="domain-email-left">
            <div class="domain-email-addr">${e.value}</div>
            <div class="domain-email-name">${[e.first_name,e.last_name].filter(Boolean).join(' ')||'Unknown'}${e.position?' ¬∑ '+e.position:''} <span class="${cClass}">${conf}%</span></div>
          </div>
          <button class="copy-btn" onclick="copyText('${e.value}',this)">Copy</button>
        `;
        list.appendChild(row);
      });
    } else {
      container.innerHTML = `<div class="empty-state"><div class="empty-icon">üîç</div><div class="empty-title">No emails found</div><div class="empty-desc">No data for <b>${domain}</b>. Check spelling or try another domain.</div></div>`;
    }
  } catch(e) { showToast('Request failed', 'error'); }
  btn.disabled = false; btn.textContent = 'Search Domain';
}

async function runBulk() {
  const raw = document.getElementById('bulkInput').value.trim();
  if (!raw) { showToast('Paste some contacts first', 'error'); return; }
  const contacts = raw.split('\n').map(l => {
    const p = l.split(',');
    return { name: p[0]?.trim(), domain: p[1]?.trim() };
  }).filter(c => c.name && c.domain);
  if (!contacts.length) { showToast('Format: Full Name, domain.com', 'error'); return; }

  const btn = document.getElementById('bulkBtn');
  btn.disabled = true; btn.textContent = 'Running...';
  const pw = document.getElementById('progressWrap');
  const pb = document.getElementById('progressBar');
  const pl = document.getElementById('progressLabel');
  pw.classList.add('on'); pl.classList.add('on');

  const results = [];
  for (let i = 0; i < contacts.length; i++) {
    const c = contacts[i];
    pb.style.width = (i / contacts.length * 100) + '%';
    pl.textContent = `${i+1} / ${contacts.length}: ${c.name}...`;
    const provider = getActiveProvider();
    if (!provider) { showToast('Out of credits!', 'error'); break; }
    try {
      const r = await findEmail(c.name, c.domain, provider);
      incrementUsed(provider);
      results.push(r);
    } catch(e) {
      results.push({ name: c.name, domain: c.domain, email: null, score: 0, position: '', provider, id: Date.now()+i });
    }
    if (i < contacts.length - 1) await new Promise(r => setTimeout(r, 700));
  }

  pb.style.width = '100%';
  const found = results.filter(r => r.email).length;
  pl.textContent = `Done ‚Äî ${found} of ${results.length} found`;
  renderResults(results, 'searchResults');
  btn.disabled = false; btn.textContent = '‚ö° Bulk Search';
}

function renderResults(contacts, containerId) {
  const found = contacts.filter(c => c.email).length;
  window._lastResults = contacts;
  document.getElementById(containerId).innerHTML = `
    <div class="results-header">
      <div class="results-title">${found} email${found!==1?'s':''} found</div>
      <button class="btn-secondary" onclick="exportThese(window._lastResults||[])">‚¨á CSV</button>
    </div>
    <div class="contacts-list" id="clist-${containerId}"></div>
  `;
  const list = document.getElementById('clist-' + containerId);
  contacts.forEach((c, i) => {
    const card = document.createElement('div');
    card.className = 'contact-card';
    card.style.animationDelay = (i * 0.05) + 's';
    const initials = c.name.split(' ').map(n => n[0]||'').join('').toUpperCase().slice(0,2) || '??';
    const sc = c.score >= 70 ? 'score-h' : c.score >= 40 ? 'score-m' : 'score-l';
    const provBadge = c.provider ? `<span class="provider-badge badge-${c.provider}">${c.provider}</span>` : '';
    const starred = isSaved(c);
    const cData = JSON.stringify(c).replace(/"/g, '&quot;');
    card.innerHTML = `
      <div class="avatar">${initials}</div>
      <div class="contact-info">
        <div class="contact-name">${c.name}</div>
        <div class="contact-meta">${c.domain}${c.position?' ¬∑ '+c.position:''}</div>
      </div>
      <div class="contact-right">
        ${provBadge}
        ${c.email
          ? `<div class="email-pill" onclick="copyText('${c.email}',this)" title="Click to copy">${c.email}</div>`
          : `<div class="email-pill empty">Not found</div>`
        }
        ${c.email ? `<div class="score-badge ${sc}">${c.score}</div>` : ''}
        ${c.email ? `<button class="icon-btn" onclick="toggleSave(this,'${cData}')">${starred?'‚≠ê':'‚òÜ'}</button>` : ''}
      </div>
    `;
    list.appendChild(card);
  });
}

function renderNotFound(containerId, name, domain, msg) {
  document.getElementById(containerId).innerHTML = `
    <div class="empty-state">
      <div class="empty-icon">üòï</div>
      <div class="empty-title">No email found for ${name}</div>
      <div class="empty-desc">${msg || 'Try a different domain or check the spelling.'}</div>
    </div>
  `;
}

function isSaved(c) { return savedLeads.some(s => s.email === c.email); }

function toggleSave(btn, cStr) {
  let c;
  try { c = JSON.parse(cStr.replace(/&quot;/g, '"')); } catch(e) { return; }
  if (isSaved(c)) {
    savedLeads = savedLeads.filter(s => s.email !== c.email);
    btn.textContent = '‚òÜ';
  } else {
    savedLeads.push(c);
    btn.textContent = '‚≠ê';
  }
  store.set('p_leads', JSON.stringify(savedLeads));
  setText('totalSaved', savedLeads.length);
}

function renderSaved() {
  if (!savedLeads.length) {
    document.getElementById('savedResults').innerHTML = `<div class="empty-state"><div class="empty-icon">‚≠ê</div><div class="empty-title">No saved leads yet</div><div class="empty-desc">Star contacts to save them here.</div></div>`;
    return;
  }
  renderResults(savedLeads, 'savedResults');
}

function exportCSV() {
  if (!savedLeads.length) { showToast('No saved leads', 'error'); return; }
  downloadCSV(savedLeads, 'saved_leads');
}

function exportThese(data) {
  const found = (data || []).filter(c => c.email);
  if (!found.length) { showToast('No emails to export', 'error'); return; }
  downloadCSV(found, 'prospector_results');
}

function exportDomainEmails() {
  const emails = (window._domainEmails || []).map(e => ({
    name: [e.first_name,e.last_name].filter(Boolean).join(' '), email: e.value, position: e.position||'', score: e.confidence||''
  }));
  if (!emails.length) return;
  downloadBlob(['Name,Email,Position,Score', ...emails.map(e => `"${e.name}","${e.email}","${e.position}","${e.score}"`)].join('\n'), 'domain_emails.csv');
  showToast('CSV downloaded!');
}

function downloadCSV(data, filename) {
  downloadBlob(['Name,Email,Domain,Position,Score,Provider', ...data.map(c => `"${c.name}","${c.email}","${c.domain}","${c.position||''}","${c.score||''}","${c.provider||''}"`)].join('\n'), filename+'.csv');
  showToast('CSV downloaded!');
}

function downloadBlob(csv, filename) {
  const a = document.createElement('a');
  a.href = URL.createObjectURL(new Blob([csv], {type:'text/csv'}));
  a.download = filename; a.click();
}

function copyText(text, el) {
  navigator.clipboard.writeText(text).then(() => {
    const orig = el.textContent;
    el.textContent = 'Copied!';
    setTimeout(() => el.textContent = orig, 1500);
    showToast('Copied to clipboard');
  });
}

function showToast(msg, type='success') {
  const t = document.getElementById('toast');
  t.innerHTML = (type==='success'?'‚úÖ':'‚ùå') + ' ' + msg;
  t.className = 'toast show';
  setTimeout(() => t.className = 'toast', 3000);
}

function toggleBulk() {
  const open = document.getElementById('bulkArea').classList.toggle('open');
  document.getElementById('bulkArrow').textContent = open ? '‚ñº' : '‚ñ∂';
}

function switchView(v, el) {
  ['search','domain','saved'].forEach(n => {
    document.getElementById('view-'+n).style.display = n===v ? 'block' : 'none';
  });
  document.querySelectorAll('.nav-item, .mobile-nav-item').forEach(i => i.classList.remove('active'));
  if(el) el.classList.add('active');
  if(v==='saved') renderSaved();
}

function openModal() { document.getElementById('keysModal').classList.add('open'); }
function closeModal(e) { if(e.target.id==='keysModal') document.getElementById('keysModal').classList.remove('open'); }
function closeModalBtn() { document.getElementById('keysModal').classList.remove('open'); updateBank(); }

document.addEventListener('DOMContentLoaded', () => {
  const k = getKeys();
  if(k.hunter) { document.getElementById('hunterKey').value = k.hunter; document.getElementById('mHunterKey').value = k.hunter; }
  if(k.snovClientId) { document.getElementById('snovClientId').value = k.snovClientId; document.getElementById('mSnovClientId').value = k.snovClientId; }
  if(k.snovClientSecret) { document.getElementById('snovClientSecret').value = k.snovClientSecret; document.getElementById('mSnovClientSecret').value = k.snovClientSecret; }
  if(k.drop) { document.getElementById('dropKey').value = k.drop; document.getElementById('mDropKey').value = k.drop; }

  updateKeyStatuses();
  updateBank();
  setText('totalSaved', savedLeads.length);

  document.getElementById('nameInput').addEventListener('keydown', e => { if(e.key==='Enter') searchContact(); });
  document.getElementById('domainInput').addEventListener('keydown', e => { if(e.key==='Enter') searchContact(); });
  document.getElementById('domainSearchInput').addEventListener('keydown', e => { if(e.key==='Enter') searchDomain(); });
});
</script>

</body>
</html>
